<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horse Customization & Payment</title>
    <script src="https://www.paypal.com/sdk/js?client-id=AQXLoLhl6HRzfms4Et1kRH3N5OiJEj8jOITyVkFWLWQjEBXtAiSylPyBdBpdyaXHhArpUMs_kNhxBiU2&components=buttons&currency=USD"></script>
    <style>
        html {
          height: 100%;
          margin: 0;
        }
        
        body {
          font-family: 'Roboto', sans-serif;
          margin: 0;
          height: 100%;
          display: flex;
          flex-direction: column;
          align-items: center;
          background-color: #f9f9f9;
          color: #333;
        }
        
        .container {
          display: flex;
          flex-direction: column;
          height: 100%;
          width: 100%;
        }
        
        header, footer {
          text-align: center;
          background-color: #ffffff;
          height: 12.5%; /* 1/8th of the screen */
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        #gallery {
          height: 30%; /* This ensures the gallery section is 30% of the screen height */
          overflow: hidden;
          position: relative;
          background-color: #f4f4f4; /* For visual distinction */
        }
        
        #carousel-container {
          width: 100%;
          height: 100%; /* Full height of #gallery */
          overflow: hidden;
          position: relative;
        }
        
        #carousel {
          display: flex; /* Arrange images in a row */
          width: max-content; /* Expand to fit the images */
          animation: scroll-left 40s linear infinite; /* Smooth scrolling animation */
        }
        
        #carousel img {
          height: 100%; /* Make images scale to fill the height of the carousel container */
          width: auto; /* Maintain aspect ratio */
          object-fit: cover; /* Make sure images cover the container without distortion */
          flex-shrink: 0; /* Prevent shrinking */
          margin: 0 5px; /* Optional: space between images */
        }
        
        /* Animation keyframes */
        @keyframes scroll-left {
          from {
            transform: translateX(0); /* Start position */
          }
          to {
            transform: translateX(-100%); /* Scroll left */
          }
        }

        #form-section {
          height: 45%; /* 4/8ths of the screen height */
          background-color: #e0e0e0; /* Just for visual distinction */
        }
        
        #form {
          background-color: #ffffff;
          overflow-y: auto;
          padding: 20px;
          box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body>
    <div class="container">
      <header>
        <h1>Model Horse Sales</h1>
      </header>
    
      <section id="gallery">
        <div id="carousel-container">
          <div id="carousel"></div>
        </div>
      </section>
    
      <section id="form-section">
            <form id="order-form">

                <!-- Email Field -->
                <label for="email">Email:</label>
                <input type="email" id="email" name="email" required><br><br>
            
                <!-- Phone Number Field -->
                <label for="phone">Phone Number:</label>
                <input type="tel" id="phone" name="phone" required><br><br>
                <!-- Model Type -->
                <label for="model-type">Model Type:</label>
                <select id="model-type" name="model-type" required>
                    <option value="1:32" data-price="50">1:32 ($50)</option>
                    <option value="1:12" data-price="150">1:12 ($150)</option>
                    <option value="1:9" data-price="300">1:9 ($300)</option>
                </select>
        
                <!-- Coat Color -->
                <label for="coat-color">Coat Color:</label>
                <select id="coat-color" name="coat-color" required>
                    <option value="Bay" data-price="0">Bay</option>
                    <option value="Chestnut" data-price="0">Chestnut</option>
                    <option value="Seal" data-price="0">Seal</option>
                    <option value="Black" data-price="0">Black</option>
                    <option value="Grey" data-price="0">Grey</option>
                    <option value="White" data-price="0">White</option>
                    <option value="Palomino" data-price="0">Palomino</option>
                    <option value="Buckskin" data-price="0">Buckskin</option>
                    <option value="Cream" data-price="0">Cream</option>
                    <option value="Dun" data-price="0">Dun</option>
                </select>
        
                <!-- Coat Markings -->
                <label for="coat-markings">Coat Markings:</label>
                <select id="coat-markings" name="coat-markings" multiple>
                    <option value="Socks" data-price="0">Socks (Free)</option>
                    <option value="Face" data-price="0">Face (Free)</option>
                    <option value="Pinto" data-price="20">Pinto (+$20/+$10 for 1:32)</option>
                    <option value="Robicano" data-price="20">Robicano (+$20/+$10 for 1:32)</option>
                    <option value="Roan" data-price="20">Roan (+$20/+$10 for 1:32)</option>
                    <option value="Blanket" data-price="20">Blanket (+$20/+$10 for 1:32)</option>
                    <option value="Leopard" data-price="20">Leopard (+$20/+$10 for 1:32)</option>
                    <option value="Snowflake" data-price="20">Snowflake (+$20/+$10 for 1:32)</option>
                    <option value="Dapple" data-price="20">Dapple (+$20/+$10 for 1:32)</option>
                    <option value="Smoky" data-price="20">Smoky (+$20/+$10 for 1:32)</option>
                </select>
        
                <!-- Build -->
                <label for="build">Build:</label>
                <select id="build" name="build" required>
                    <option value="Standard" data-price="0">Standard (Free)</option>
                    <option value="Pony" data-price="0">Pony (Free)</option>
                    <option value="Mini" data-price="0">Mini (Free)</option>
                    <option value="Draft" data-price="40">Draft (+$40/+$20 for 1:32)</option>
                    <option value="Specific Breed" data-price="70">Specific Breed (+$70/+$35 for 1:32)</option>
                </select>
        
                <!-- Pose -->
                <label for="pose">Pose:</label>
                <select id="pose" name="pose" required>
                    <option value="Standing" data-price="0">Standing (Free)</option>
                    <option value="Walking" data-price="0">Walking (Free)</option>
                    <option value="Running" data-price="20">Running (+$20/+$10 for 1:32)</option>
                    <option value="Special Gait" data-price="40">Special Gait (+$40/+$20 for 1:32)</option>
                    <option value="Jumping" data-price="40">Jumping (+$40/+$20 for 1:32)</option>
                    <option value="Rearing" data-price="40">Rearing (+$40/+$20 for 1:32)</option>
                    <option value="Dynamic" data-price="70">Dynamic (+$70/+$35 for 1:32)</option>
                </select>
        
                <!-- Accessories -->
                <label for="accessories">Accessories:</label>
                <select id="accessories" name="accessories" multiple>
                    <option value="Diorama" data-price="70">Diorama (+$70/+35 for 1:32)</option>
                    <option value="Tack" data-price="150">Tack (+$150/+75 for 1:32)</option>
                </select>
    
                <!-- Notes Field -->
                <label for="notes">Notes:</label>
                <textarea id="notes" name="notes" rows="4" cols="50" placeholder="Enter any additional notes here"></textarea><br><br>
            </form>
        </section>

        <footer>
            <!-- Total Price -->
            <h3>Total Price: <span id="total-price">$0.00</span></h3>
            <h3>Payment Due: <span id="payment-due">$0.00</span></h3>
            
            <!-- PayPal Button -->
            <div class="paypal-button-container">
                <div id="paypal-button-container"></div>
            </div>
        </footer>
        
    </div>
    <!-- JavaScript -->
    <script>
        const galleries = {
          "1:9": [
            { src: "9/AppaloosaSportHorse9.png", alt: "Appaloosa Sporthorse" },
            { src: "9/BloodBayArabian9.png", alt: "Blood Bay Arabian" },
            { src: "9/BuckskinQuarterhorse9.png", alt: "Buckskin Quarterhorse" },
            { src: "9/ClevelandBay9.png", alt: "Cleveland Bay" },
            { src: "9/DappleGreyDraftHorse9.png", alt: "Dapple Grey Draft" },
            { src: "9/DunWelshCob9.png", alt: "Dun Welsh Cob" },
            { src: "9/DutchWarmbloodTobanio9.png", alt: "Dutch Warmblood Tobanio" },
            { src: "9/GreyedDrafthorseBuckskin9.png", alt: "Buckskin Greyed Draft" },
            { src: "9/LeopardAppaloosa9.png", alt: "Leopard Appaloosa" },
            { src: "9/DappleGreyMorgan9.png", alt: "Dapple Grey Morgan" },
            { src: "9/BayRussianHeavyDraft9.png", alt: "Bay Russian Heavy Draft" },
          ],
          "1:12": [
            { src: "12/AppaloosaSportHorse12.png", alt: "Appaloosa Sport Horse" },
            { src: "12/BlackHanoverian12.png", alt: "Black Hanoverian" },
            { src: "12/BloodBayArabian12.png", alt: "Blood Bay Arabian" },
            { src: "12/BuckskinQuarterhorse12.png", alt: "Buckskin Quarterhorse" },
            { src: "12/ClevelandBay12.png", alt: "Cleveland Bay" },
            { src: "12/DappleGreyMorgan12.png", alt: "Dapple Grey Morgan" },
            { src: "12/DutchWarmbloodTobanio12.png", alt: "Tobanio Dutch Warmblood" },
            { src: "12/GreyedDrafthorseBuckskin12.png", alt: "Buckskin Greyed Draft" },
            { src: "12/LeopardAppaloosa12.png", alt: "Leopard Appaloosa" },
            { src: "12/NezPerceAppaloosa12.png", alt: "Blanket Nez Perce" },
            { src: "12/PalominoQuarterhorse12.png", alt: "Palomino Quarterhorse" },
            { src: "12/RedBayTW12.png", alt: "Red Bay Tennessee Walking Horse" },
          ],
          "1:32": [
            { src: "32/32Chestnutsockfacestandardwalking.png", alt: "Bay Trakehner" },
            { src: "32/32baysockstandardstanding.png", alt: "Gypsy Vanner" },
            { src: "32/32blackfacesocksdraftrearing.png", alt: "Irish Sporthorse" },
            { src: "32/32dunfacesocksnowflakestandardrearing.png", alt: "Dun Snowflake Appaloosa" },
            { src: "32/32greydapplestandardrunning.png", alt: "Dapple Grey Dutch Warmblood" },
            { src: "32/AppaloosaSportHorse32.png", alt: "Appaloosa Sporthorse" },
            { src: "32/BlackHanoverian32.png", alt: "Black Hanoverian" },
            { src: "32/BloodBayArabian32.png", alt: "Blood Bay Arabian" },
            { src: "32/BuckskinQuarterhorse32.png", alt: "Buckskin Quarterhorse" },
            { src: "32/ClevelandBay32.png", alt: "Cleveland Bay" },
            { src: "32/DappleGreyMorgan32.png", alt: "Dapple Grey Morgan" },
            { src: "32/DutchWarmbloodTobanio32.png", alt: "Tobanio Dutch Warmblood" },
            { src: "32/GreyedDrafthorseBuckskin32.png", alt: "Buckskin Greyed Draft" },
            { src: "32/LeopardAppaloosa32.png", alt: "Leopard Appaloosa" },
          ],
        };

        
        
        const scaleSelect = document.getElementById('model-type');
        const carousel = document.getElementById('carousel');

        function updateGallery(scale) {
          carousel.innerHTML = ''; // Clear existing images
        
          // Add images to the carousel
          galleries[scale].forEach((image) => {
            const img = document.createElement('img');
            img.src = image.src;
            img.alt = image.alt;
            carousel.appendChild(img);
          });
        
          // Clone the images to make the carousel seamless
          galleries[scale].forEach((image) => {
            const img = document.createElement('img');
            img.src = image.src;
            img.alt = image.alt;
            carousel.appendChild(img.cloneNode());
          });
        }
        
        // Initialize with the first scale
        updateGallery(scaleSelect.value);
        
        // Update gallery when scale changes
        scaleSelect.addEventListener('change', (e) => {
          updateGallery(e.target.value);
        });

        
        document.addEventListener("DOMContentLoaded", function () {
            const scaleSelect = document.getElementById("model-type");
            const coatMarkingsSelect = document.getElementById("coat-markings");
            const buildSelect = document.getElementById("build");
            const poseSelect = document.getElementById("pose");
            const accessoriesSelect = document.getElementById("accessories");
            const totalPriceElement = document.getElementById("total-price");
            const paymentDueElement = document.getElementById("payment-due");
            const form = document.getElementById("order-form");
    
            let totalPrice = 0; // Full price
            let paymentDue = 0; // Halved price for checkout
    
            // Function to update the total price dynamically
            function updateTotalPrice() {
                totalPrice = parseInt(scaleSelect.options[scaleSelect.selectedIndex].dataset.price) || 0;
    
                // Check if the selected scale is 1:32 (half price for add-ons)
                const isSmallScale = scaleSelect.value === "1:32";
    
                // Add the cost of coat markings
                Array.from(coatMarkingsSelect.selectedOptions).forEach(option => {
                    const addonPrice = parseInt(option.dataset.price) || 0;
                    totalPrice += isSmallScale ? addonPrice / 2 : addonPrice;
                });
    
                // Add the cost of build
                const buildPrice = parseInt(buildSelect.options[buildSelect.selectedIndex].dataset.price) || 0;
                totalPrice += isSmallScale ? buildPrice / 2 : buildPrice;
    
                // Add the cost of pose
                const posePrice = parseInt(poseSelect.options[poseSelect.selectedIndex].dataset.price) || 0;
                totalPrice += isSmallScale ? posePrice / 2 : posePrice;
    
                // Add the cost of accessories
                Array.from(accessoriesSelect.selectedOptions).forEach(option => {
                    const addonPrice = parseInt(option.dataset.price) || 0;
                    totalPrice += isSmallScale ? addonPrice / 2 : addonPrice;
                });

                // Calculate payment due (halved total price)
                paymentDue = totalPrice / 2;

                if (isNaN(totalPrice) || isNaN(paymentDue)) {
                    alert('Total price or payment due is invalid');
                    return;
                }
    
                // Update the total price display
                totalPriceElement.textContent = `$${totalPrice.toFixed(2)}`;
                paymentDueElement.textContent = `$${paymentDue.toFixed(2)}`;
            }
    
                // Function to render the PayPal button
                function renderPayPalButton() {
                paypal.Buttons({
                    createOrder: function (data, actions) {
                        return actions.order.create({
                            purchase_units: [{
                                amount: {
                                    value: paymentDue.toFixed(2) // Send halved price to PayPal
                                }
                            }]
                        });
                    },
                    onApprove: function (data, actions) {
                        return actions.order.capture().then(function (details) {
                            alert('Transaction completed by ' + details.payer.name.given_name);
    
                            // Prepare data for Formspree submission
                            const formData = {
                                email: form.email.value,
                                phone: form.phone.value,
                                scale: form['model-type'].value,
                                coatColor: form['coat-color'].value,
                                coatMarkings: Array.from(form['coat-markings'].selectedOptions).map(option => option.value),
                                build: form['build'].value,
                                pose: form['pose'].value,
                                accessories: Array.from(form['accessories'].selectedOptions).map(option => option.value),
                                notes: form.notes.value,
                                transactionId: details.id,
                                totalPrice: totalPrice.toFixed(2),
                                paymentDue: paymentDue.toFixed(2),
                                payerName: details.payer.name.given_name,
                                payerEmail: details.payer.email_address,
                                paymentCompleted: details.purchase_units[0].payments.captures[0].amount.value
                            };
    
                            // Submit form data to Formspree via AJAX
                            submitToFormspree(formData);
                        });
                    }
                }).render('#paypal-button-container');
            }
    
            // Function to submit form data to Formspree
            function submitToFormspree(data) {
                fetch("https://formspree.io/f/myzyapwz", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (response.ok) {
                    } else {
                        alert("Failed to submit the order. Please try again.");
                    }
                })
                .catch(error => {
                    console.error("Error submitting to Formspree:", error);
                    alert("An error occurred. Please try again.");
                });
            }
    
            // Event listeners for inputs to update total price
            scaleSelect.addEventListener("change", updateTotalPrice);
            coatMarkingsSelect.addEventListener("change", updateTotalPrice);
            buildSelect.addEventListener("change", updateTotalPrice);
            poseSelect.addEventListener("change", updateTotalPrice);
            accessoriesSelect.addEventListener("change", updateTotalPrice);
    
            // Render the PayPal button when the page loads
            renderPayPalButton();
    
            // Update price when the form is loaded
            updateTotalPrice();
        });
    </script>
</body>
</html>
