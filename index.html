<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Horse Customization & Payment</title>
    <script src="https://www.paypal.com/sdk/js?client-id=AQXLoLhl6HRzfms4Et1kRH3N5OiJEj8jOITyVkFWLWQjEBXtAiSylPyBdBpdyaXHhArpUMs_kNhxBiU2&components=buttons&currency=USD"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
        }

        h1 {
            text-align: center;
        }

        #gallery {
            display: flex;
            justify-content: center;
            margin: 20px;
        }

        #gallery img {
            width: 200px;
            height: 200px;
            margin: 5px;
        }

        .form-container {
            text-align: center;
            margin-top: 20px;
        }

        .form-container select, .form-container input[type="text"], .form-container input[type="email"], .form-container input[type="tel"] {
            width: 200px;
            padding: 10px;
            margin: 10px;
        }

        .paypal-button-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }
    </style>
</head>
<body>
    <h1>Horse Customization and Order</h1>

    <!-- Gallery -->
    <div id="gallery">
        <!-- Images for each scale: 1:9th, 1:12th, and 1:32nd -->
        <div id="gallery-9" class="gallery-folder">
            <h3>1:9th Scale Horses</h3>
            <img src="9/AppaloosaSportHorse9.png" alt="Appaloosa Sporthorse">
            <img src="9/BloodBayArabian9.png" alt="Blood Bay Arabian">
            <img src="9/BuckskinQuarterhorse9.png" alt="Buckskin Quarterhorse">
            <img src="9/ClevelandBay9.png" alt="Cleveland Bay">
            <img src="9/DappleGreyDraftHorse9.png" alt="Dapple Grey Draft">
            <img src="9/DunWelshCob9.png" alt="Dun Welsh Cob">
            <img src="9/DutchWarmbloodTobanio9.png" alt="Dutch Warmblood Tobanio">
            <img src="9/GreyedDrafthorseBuckskin9.png" alt="Buckskin Greyed Draft">
            <img src="9/LeopardAppaloosa9.png" alt="Leopard Appaloosa">
            <img src="9/DappleGreyMorgan9.png" alt="Dapple Grey Morgan">
            <img src="9/BayRussianHeavyDraft9.png" alt="Bay Russian Heavy Draft">
        </div>
        <div id="gallery-12" class="gallery-folder">
            <h3>1:12th Scale Horses</h3>
            <img src="12/AppaloosaSportHorse12.png" alt="Appaloosa Sport Horse ">
            <img src="12/BlackHanoverian12.png" alt="Black Hanoverian">
            <img src="12/BloodBayArabian12.png" alt="Blood Bay Arabian">
            <img src="12/BuckskinQuarterhorse12.png" alt="Buckskin Quarterhorse">
            <img src="12/ClevelandBay12.png" alt="Cleveland Bay">
            <img src="12/DappleGreyMorgan12.png" alt="Dapple Grey Morgan">
            <img src="12/DutchWarmbloodTobanio12.png" alt="Tobanio Dutch Warmblood">
            <img src="12/GreyedDrafthorseBuckskin12.png" alt="Buckskin Greyed Draft">
            <img src="12/LeopardAppaloosa12.png" alt="Leopard Appaloosa">
            <img src="12/NezPerceAppaloosa12.png" alt="Blanket Nez Perce">
            <img src="12/PalominoQuarterhorse12.png" alt="Palomino Quarterhorse">
            <img src="12/RedBayTW12.png" alt="Red Bay Tennessee Walking Horse">
        </div>
        <div id="gallery-32" class="gallery-folder">
            <h3>1:32nd Scale Horses</h3>
            <img src="32/32Chestnutsockfacestandardwalking.png" alt="Bay Trakehner">
            <img src="32/32baysockstandardstanding.png" alt="Gypsy Vanner">
            <img src="32/32blackfacesocksdraftrearing.png" alt="Irish Sporthorse">
            <img src="32/32dunfacesocksnowflakestandardrearing.png" alt="Dun Snowflake Appaloosa">
            <img src="32/32greydapplestandardrunning.png" alt="Dapple Grey Dutch Warmblood">
            <img src="32/AppaloosaSportHorse32.png" alt="Appaloosa Sporthorse">
            <img src="32/BlackHanoverian32.png" alt="Black Hanoverian">
            <img src="32/BloodBayArabian32.png" alt="Blood Bay Arabian">
            <img src="32/BuckskinQuarterhorse32.png" alt="Buckskin Quarterhorse">
            <img src="32/ClevelandBay32.png" alt="Cleveland Bay">
            <img src="32/DappleGreyMorgan32.png" alt="Dapple Grey Morgan">
            <img src="32/DutchWarmbloodTobanio32.png" alt="Tobanio Dutch Warmblood">
            <img src="32/GreyedDrafthorseBuckskin32.png" alt="Buckskin Greyed Draft">
            <img src="32/LeopardAppaloosa32.png" alt="Leopard Appaloosa">
        </div>
    </div>

    <div class="order-form">
        <h1>Custom Horse Model Order</h1>
        <!-- Form -->
        <form id="order-form">
            <!-- Model Type -->
            <label for="model-type">Model Type:</label>
            <select id="model-type" name="model-type" required>
                <option value="1:32" data-price="50">1:32 ($50)</option>
                <option value="1:12" data-price="150">1:12 ($150)</option>
                <option value="1:9" data-price="300">1:9 ($300)</option>
            </select>
    
            <!-- Coat Color -->
            <label for="coat-color">Coat Color:</label>
            <select id="coat-color" name="coat-color" required>
                <option value="Bay" data-price="0">Bay</option>
                <option value="Chestnut" data-price="0">Chestnut</option>
                <option value="Seal" data-price="0">Seal</option>
                <option value="Black" data-price="0">Black</option>
                <option value="Grey" data-price="0">Grey</option>
                <option value="White" data-price="0">White</option>
                <option value="Palomino" data-price="0">Palomino</option>
                <option value="Buckskin" data-price="0">Buckskin</option>
                <option value="Cream" data-price="0">Cream</option>
                <option value="Dun" data-price="0">Dun</option>
            </select>
    
            <!-- Coat Markings -->
            <label for="coat-markings">Coat Markings:</label>
            <select id="coat-markings" name="coat-markings" multiple>
                <option value="Socks" data-price="0">Socks (Free)</option>
                <option value="Face" data-price="0">Face (Free)</option>
                <option value="Pinto" data-price="20">Pinto (+$20/+10 for 1:32)</option>
                <option value="Robicano" data-price="20">Robicano (+$20/+10 for 1:32)</option>
                <option value="Roan" data-price="20">Roan (+$20/+10 for 1:32)</option>
                <option value="Blanket" data-price="20">Blanket (+$20/+10 for 1:32)</option>
                <option value="Leopard" data-price="20">Leopard (+$20/+10 for 1:32)</option>
                <option value="Snowflake" data-price="20">Snowflake (+$20/+10 for 1:32)</option>
                <option value="Dapple" data-price="20">Dapple (+$20/+10 for 1:32)</option>
                <option value="Smoky" data-price="20">Smoky (+$20/+10 for 1:32)</option>
            </select>
    
            <!-- Build -->
            <label for="build">Build:</label>
            <select id="build" name="build" required>
                <option value="Standard" data-price="0">Standard (Free)</option>
                <option value="Pony" data-price="0">Pony (Free)</option>
                <option value="Mini" data-price="0">Mini (Free)</option>
                <option value="Draft" data-price="40">Draft (+$40/+20 for 1:32)</option>
                <option value="Specific Breed" data-price="70">Specific Breed (+$70/+35 for 1:32)</option>
            </select>
    
            <!-- Pose -->
            <label for="pose">Pose:</label>
            <select id="pose" name="pose" required>
                <option value="Standing" data-price="0">Standing (Free)</option>
                <option value="Walking" data-price="0">Walking (Free)</option>
                <option value="Running" data-price="20">Running (+$20/+10 for 1:32)</option>
                <option value="Special Gait" data-price="40">Special Gait (+$40/+20 for 1:32)</option>
                <option value="Jumping" data-price="40">Jumping (+$40/+20 for 1:32)</option>
                <option value="Rearing" data-price="40">Rearing (+$40/+20 for 1:32)</option>
                <option value="Dynamic" data-price="70">Dynamic (+$70/+35 for 1:32)</option>
            </select>
    
            <!-- Accessories -->
            <label for="accessories">Accessories:</label>
            <select id="accessories" name="accessories" multiple>
                <option value="Diorama" data-price="70">Diorama (+$70/+35 for 1:32)</option>
                <option value="Tack" data-price="150">Tack (+$150/+75 for 1:32)</option>
            </select>
    
            <!-- Total Price -->
            <h3>Total Price: <span id="total-price">$0.00</span></h3>
            <h3>Payment Due: <span id="payment-due">$0.00</span></h3>
        </form>

        <!-- PayPal Button -->
        <div class="paypal-button-container">
            <div id="paypal-button-container"></div>
        </div>
    </div>

        <!-- JavaScript -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const scaleSelect = document.getElementById("model-type");
            const coatMarkingsSelect = document.getElementById("coat-markings");
            const buildSelect = document.getElementById("build");
            const poseSelect = document.getElementById("pose");
            const accessoriesSelect = document.getElementById("accessories");
            const totalPriceElement = document.getElementById("total-price");
            const paymentDueElement = document.getElementById("payment-due");
            const form = document.getElementById("order-form");
    
            let totalPrice = 0; // Full price
            let paymentDue = 0; // Halved price for checkout
    
            // Function to update the total price dynamically
            function updateTotalPrice() {
                totalPrice = parseInt(scaleSelect.options[scaleSelect.selectedIndex].dataset.price) || 0;
    
                // Check if the selected scale is 1:32 (half price for add-ons)
                const isSmallScale = scaleSelect.value === "1:32";
    
                // Add the cost of coat markings
                Array.from(coatMarkingsSelect.selectedOptions).forEach(option => {
                    const addonPrice = parseInt(option.dataset.price) || 0;
                    totalPrice += isSmallScale ? addonPrice / 2 : addonPrice;
                });
    
                // Add the cost of build
                const buildPrice = parseInt(buildSelect.options[buildSelect.selectedIndex].dataset.price) || 0;
                totalPrice += isSmallScale ? buildPrice / 2 : buildPrice;
    
                // Add the cost of pose
                const posePrice = parseInt(poseSelect.options[poseSelect.selectedIndex].dataset.price) || 0;
                totalPrice += isSmallScale ? posePrice / 2 : posePrice;
    
                // Add the cost of accessories
                Array.from(accessoriesSelect.selectedOptions).forEach(option => {
                    const addonPrice = parseInt(option.dataset.price) || 0;
                    totalPrice += isSmallScale ? addonPrice / 2 : addonPrice;
                });

                // Calculate payment due (halved total price)
                paymentDue = totalPrice / 2;

                if (isNaN(totalPrice) || isNaN(paymentDue)) {
                    alert('Total price or payment due is invalid');
                    return;
                }
    
                // Update the total price display
                totalPriceElement.textContent = `$${totalPrice.toFixed(2)}`;
                paymentDueElement.textContent = `$${paymentDue.toFixed(2)}`;
            }
    
                // Function to render the PayPal button
                function renderPayPalButton() {
                paypal.Buttons({
                    createOrder: function (data, actions) {
                        return actions.order.create({
                            purchase_units: [{
                                amount: {
                                    value: paymentDue.toFixed(2) // Send halved price to PayPal
                                }
                            }]
                        });
                    },
                    onApprove: function (data, actions) {
                        return actions.order.capture().then(function (details) {
                            alert('Transaction completed by ' + details.payer.name.given_name);
    
                            // Prepare data for Formspree submission
                            const formData = {
                                email: form.email.value,
                                phone: form.phone.value,
                                scale: form.scale.value,
                                coatColor: form['coat-color'].value,
                                coatMarkings: Array.from(form['coat-markings'].selectedOptions).map(option => option.value),
                                build: form.build.value,
                                pose: form.pose.value,
                                accessories: Array.from(form['accessories'].selectedOptions).map(option => option.value),
                                transactionId: details.id,
                                totalPrice: totalPrice.toFixed(2), // Full price
                                paymentDue: paymentDue.toFixed(2), // Halved price
                                payerName: details.payer.name.given_name,
                                payerEmail: details.payer.email_address
                            };
    
                            // Submit form data to Formspree via AJAX
                            submitToFormspree(formData);
                        });
                    }
                }).render('#paypal-button-container');
            }
    
            // Function to submit form data to Formspree
            function submitToFormspree(data) {
                fetch("https://formspree.io/f/myzyapwz", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(data)
                })
                .then(response => {
                    if (response.ok) {
                        alert("Order submitted successfully!");
                    } else {
                        alert("Failed to submit the order. Please try again.");
                    }
                })
                .catch(error => {
                    console.error("Error submitting to Formspree:", error);
                    alert("An error occurred. Please try again.");
                });
            }
    
            // Event listeners for inputs to update total price
            scaleSelect.addEventListener("change", updateTotalPrice);
            coatMarkingsSelect.addEventListener("change", updateTotalPrice);
            buildSelect.addEventListener("change", updateTotalPrice);
            poseSelect.addEventListener("change", updateTotalPrice);
            accessoriesSelect.addEventListener("change", updateTotalPrice);
    
            // Render the PayPal button when the page loads
            renderPayPalButton();
    
            // Update price when the form is loaded
            updateTotalPrice();
        });
    </script>
</body>
</html>
